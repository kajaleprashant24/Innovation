{"paragraphs":[{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"place","index":0,"aggr":"sum"}],"values":[{"name":"c","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"place","index":0,"aggr":"sum"},"yAxis":{"name":"c","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1484429814331_139080122","id":"20170114-213654_2132204436","dateCreated":"2017-01-14T21:36:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2074","text":"%sql\nSELECT place,count(*) as c FROM EntertainmentTable where text LIKE '%Jordan %' and place is not null  group by place order by c desc limit 10","user":"anonymous","dateUpdated":"2017-01-14T21:37:02+0000","dateFinished":"2017-01-14T21:37:03+0000","dateStarted":"2017-01-14T21:37:02+0000","result":{"code":"SUCCESS","type":"TABLE","msg":"place\tc\n"}},{"text":"import org.apache.spark.SparkConf;\r\nimport org.apache.spark.SparkContext;\r\nimport org.apache.spark.sql.SQLContext;\r\n\r\nSystem.setProperty(\"hadoop.home.dir\",\"/usr/hadoop-2.7.3/bin\");\r\n// initialise spark context\r\n//val conf = new SparkConf().setAppName(\"PbSpark\").setMaster(\"local[2]\").set(\"spark.executor.memory\", \"4g\").set(\"spark.driver.allowMultipleContexts\",\"true\");\r\n//val sc = new SparkContext(conf);\r\n\r\n//val sqlContext = new SQLContext(sc);\r\nval EntertainmentTable = sqlContext.jsonFile(\"/usr/tweets/tweets3.json\");\r\nEntertainmentTable.registerTempTable(\"Test1\");\r\n//EntertainmentTable.printSchema();\r\nval maxTweets =sqlContext.sql(\"SELECT lang, count(*) as c FROM Test1 where lang is not null  group by lang order by c desc limit 10\");\r\n//sqlContext.sql(\"SELECT TRIM( REGEXP_REPLACE( SUBSTR(source,instr(source,”>”)+1),”/a>”,”” ) ) AS Device, COUNT(TRIM(source)) AS PerCount FROM zumamustfall_db.zmf_tweets GROUP BY TRIM( REGEXP_REPLACE( SUBSTR(source,instr(source,”>”)+1),”/a>”,”” ) ) HAVING COUNT(TRIM(source)) >= 2 ORDER BY PerCount DESC LIMIT 10 \"); \r\n  //sqlContext.sql(\"SELECT lang, count(*) as c FROM EntertainmentTable where lang is not null  group by lang order by c desc limit 10\");\r\nmaxTweets.show();\r\nEntertainmentTable.show();\r\nmaxTweets.rdd.saveAsTextFile(\"/usr/tweets/tweetsTest\");","dateUpdated":"2017-01-14T21:38:34+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1484429822254_1570361354","id":"20170114-213702_78513006","dateCreated":"2017-01-14T21:37:02+0000","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2159","user":"anonymous","dateFinished":"2017-01-14T21:38:37+0000","dateStarted":"2017-01-14T21:38:34+0000","result":{"code":"ERROR","type":"TEXT","msg":"\nimport org.apache.spark.SparkConf\n\nimport org.apache.spark.SparkContext\n\nimport org.apache.spark.sql.SQLContext\n\nres155: String = /usr/hadoop-2.7.3/bin\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\nEntertainmentTable: org.apache.spark.sql.DataFrame = [contributors: string, coordinates: string ... 31 more fields]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\nmaxTweets: org.apache.spark.sql.DataFrame = [lang: string, c: bigint]\n+----+---+\n|lang|  c|\n+----+---+\n|  en|973|\n| und| 18|\n|  sv| 17|\n|  pl| 12|\n|  ht| 11|\n|  de| 10|\n|  in| 10|\n|  pt| 10|\n|  fr|  8|\n|  nl|  6|\n+----+---+\n\n+------------+-----------+--------------------+------------------+--------------------+--------------------+--------------------+--------------+---------+------------+----+------------------+------------------+-----------------------+---------------------+-------------------------+-------------------+-----------------------+---------------+----+-----+------------------+-------------+----------------+--------------------+-------------+---------+----------------+--------------------+--------------------+-------------+---------+--------------------+\n|contributors|coordinates|          created_at|display_text_range|            entities|   extended_entities|      extended_tweet|favorite_count|favorited|filter_level| geo|                id|            id_str|in_reply_to_screen_name|in_reply_to_status_id|in_reply_to_status_id_str|in_reply_to_user_id|in_reply_to_user_id_str|is_quote_status|lang|place|possibly_sensitive|quoted_status|quoted_status_id|quoted_status_id_str|retweet_count|retweeted|retweeted_status|              source|                text| timestamp_ms|truncated|                user|\n+------------+-----------+--------------------+------------------+--------------------+--------------------+--------------------+--------------+---------+------------+----+------------------+------------------+-----------------------+---------------------+-------------------------+-------------------+-----------------------+---------------+----+-----+------------------+-------------+----------------+--------------------+-------------+---------+----------------+--------------------+--------------------+-------------+---------+--------------------+\n|        null|       null|Mon Jan 16 12:04:...|              null|[WrappedArray([Wr...|                null|                null|             0|    false|         low|null|820964968241606657|820964968241606657|                   null|                 null|                     null|               null|                   null|          false|  en| null|             false|         null|            null|                null|            0|    false|            null|<a href=\"https://...|#nike #shoes Nike...|1484568275877|    false|[false,Sun Jan 24...|\n|        null|       null|Mon Jan 16 12:04:...|              null|[WrappedArray([Wr...|                null|                null|             0|    false|         low|null|820965011845566464|820965011845566464|                   null|                 null|                     null|               null|                   null|          false|  en| null|             false|         null|            null|                null|            0|    false|            null|<a href=\"https://...|#Nice #Nike KD 6 ...|1484568286273|    false|[false,Fri Jun 08...|\n|        null|       null|Mon Jan 16 12:05:...|              null|[WrappedArray([Wr...|                null|                null|             0|    false|         low|null|820965297771466755|820965297771466755|                   null|                 null|                     null|               null|                   null|          false|  en| null|             false|         null|            null|                null|            0|    false|            null|<a href=\"http://i...|https://t.co/BqWN...|1484568354443|    false|[false,Tue Feb 10...|\n|        null|       null|Mon Jan 16 12:05:...|              null|[WrappedArray(),n...|                null|                null|             0|    false|         low|null|820965311826501632|820965311826501632|                   null|                 null|                     null|               null|                   null|          false|  en| null|             false|         null|            null|                null|            0|    false|            null|<a href=\"http://i...|Nike Air Max Ligh...|1484568357794|    false|[false,Mon Aug 29...|\n|        null|       null|Mon Jan 16 12:06:...|           [0, 78]|[WrappedArray([Wr...|[WrappedArray([pi...|                null|             0|    false|         low|null|820965451467550721|820965451467550721|                   null|                 null|                     null|               null|                   null|          false|  es| null|             false|         null|            null|                null|            0|    false|            null|<a href=\"http://i...|https://t.co/8TrI...|1484568391087|    false|[false,Sun Feb 15...|\n|        null|       null|Mon Jan 16 12:06:...|           [0, 74]|[WrappedArray([Wr...|[WrappedArray([pi...|                null|             0|    false|         low|null|820965464113291264|820965464113291264|                   null|                 null|                     null|               null|                   null|          false|  en| null|             false|         null|            null|                null|            0|    false|            null|<a href=\"http://i...|https://t.co/Uevb...|1484568394102|    false|[false,Sun Feb 15...|\n|        null|       null|Mon Jan 16 12:06:...|          [0, 105]|[WrappedArray([Wr...|[WrappedArray([pi...|                null|             0|    false|         low|null|820965485462355968|820965485462355968|                   null|                 null|                     null|               null|                   null|          false|  en| null|             false|         null|            null|                null|            0|    false|            null|<a href=\"http://i...|https://t.co/rWlK...|1484568399192|    false|[false,Sun Feb 15...|\n|        null|       null|Mon Jan 16 12:06:...|           [0, 72]|[WrappedArray([Wr...|[WrappedArray([pi...|                null|             0|    false|         low|null|820965492437479424|820965492437479424|                   null|                 null|                     null|               null|                   null|          false|  en| null|             false|         null|            null|                null|            0|    false|            null|<a href=\"http://i...|https://t.co/hxEw...|1484568400855|    false|[false,Sun Feb 15...|\n|        null|       null|Mon Jan 16 12:06:...|           [0, 92]|[WrappedArray([Wr...|[WrappedArray([pi...|                null|             0|    false|         low|null|820965498665992192|820965498665992192|                   null|                 null|                     null|               null|                   null|          false|  en| null|             false|         null|            null|                null|            0|    false|            null|<a href=\"http://i...|https://t.co/ge68...|1484568402340|    false|[false,Sun Feb 15...|\n|        null|       null|Mon Jan 16 12:06:...|           [0, 97]|[WrappedArray([Wr...|[WrappedArray([pi...|                null|             0|    false|         low|null|820965503569133568|820965503569133568|                   null|                 null|                     null|               null|                   null|          false|  en| null|             false|         null|            null|                null|            0|    false|            null|<a href=\"http://i...|https://t.co/b38H...|1484568403509|    false|[false,Sun Feb 15...|\n|        null|       null|Mon Jan 16 12:06:...|           [0, 76]|[WrappedArray([Wr...|[WrappedArray([pi...|                null|             0|    false|         low|null|820965509474766848|820965509474766848|                   null|                 null|                     null|               null|                   null|          false|  en| null|             false|         null|            null|                null|            0|    false|            null|<a href=\"http://i...|https://t.co/d1sN...|1484568404917|    false|[false,Sun Feb 15...|\n|        null|       null|Mon Jan 16 12:06:...|           [0, 88]|[WrappedArray([Wr...|[WrappedArray([pi...|                null|             0|    false|         low|null|820965515451650048|820965515451650048|                   null|                 null|                     null|               null|                   null|          false|  en| null|             false|         null|            null|                null|            0|    false|            null|<a href=\"http://i...|https://t.co/nwYD...|1484568406342|    false|[false,Sun Feb 15...|\n|        null|       null|Mon Jan 16 12:06:...|          [0, 110]|[WrappedArray([Wr...|[WrappedArray([pi...|                null|             0|    false|         low|null|820965521583706113|820965521583706113|                   null|                 null|                     null|               null|                   null|          false|  en| null|             false|         null|            null|                null|            0|    false|            null|<a href=\"http://i...|https://t.co/3HrW...|1484568407804|    false|[false,Sun Feb 15...|\n|        null|       null|Mon Jan 16 12:07:...|          [0, 114]|[WrappedArray([Wr...|[WrappedArray([pi...|                null|             0|    false|         low|null|820965590617591812|820965590617591812|                   null|                 null|                     null|               null|                   null|          false|  nl| null|             false|         null|            null|                null|            0|    false|            null|<a href=\"https://...|#Shoes #Center: #...|1484568424263|    false|[false,Tue Oct 11...|\n|        null|       null|Mon Jan 16 12:07:...|          [0, 110]|[WrappedArray([Wr...|[WrappedArray([pi...|                null|             0|    false|         low|null|820965604517519360|820965604517519360|                   null|                 null|                     null|               null|                   null|          false|  en| null|             false|         null|            null|                null|            0|    false|            null|<a href=\"https://...|#Shoes #Mall: #Ni...|1484568427577|    false|[false,Thu Oct 27...|\n|        null|       null|Mon Jan 16 12:07:...|          [0, 140]|[WrappedArray([Wr...|                null|[WrappedArray(0, ...|             0|    false|         low|null|820965606958645251|820965606958645251|                   null|                 null|                     null|               null|                   null|          false|  en| null|             false|         null|            null|                null|            0|    false|            null|<a href=\"https://...|#Shoe #Style: #Ni...|1484568428159|     true|[false,Sun Aug 21...|\n|        null|       null|Mon Jan 16 12:07:...|          [0, 140]|[WrappedArray([Wr...|                null|[WrappedArray(0, ...|             0|    false|         low|null|820965609252921345|820965609252921345|                   null|                 null|                     null|               null|                   null|          false|  sl| null|             false|         null|            null|                null|            0|    false|            null|<a href=\"https://...|#Shoes #Store: #N...|1484568428706|     true|[false,Thu Feb 27...|\n|        null|       null|Mon Jan 16 12:07:...|          [0, 140]|[WrappedArray([Wr...|                null|[WrappedArray(0, ...|             0|    false|         low|null|820965619176587264|820965619176587264|                   null|                 null|                     null|               null|                   null|          false|  en| null|             false|         null|            null|                null|            0|    false|            null|<a href=\"https://...|#Shoes: #Nike AIR...|1484568431072|     true|[false,Mon Jun 20...|\n|        null|       null|Mon Jan 16 12:07:...|          [0, 109]|[WrappedArray([Wr...|[WrappedArray([pi...|                null|             0|    false|         low|null|820965625384161280|820965625384161280|                   null|                 null|                     null|               null|                   null|          false|  en| null|             false|         null|            null|                null|            0|    false|            null|<a href=\"https://...|#Shoes #Trend: #N...|1484568432552|    false|[false,Mon Sep 10...|\n|        null|       null|Mon Jan 16 12:07:...|          [0, 113]|[WrappedArray([Wr...|[WrappedArray([pi...|                null|             0|    false|         low|null|820965628022386688|820965628022386688|                   null|                 null|                     null|               null|                   null|          false|  pl| null|             false|         null|            null|                null|            0|    false|            null|<a href=\"https://...|#Athletic #Shoes:...|1484568433181|    false|[false,Fri Apr 01...|\n+------------+-----------+--------------------+------------------+--------------------+--------------------+--------------------+--------------+---------+------------+----+------------------+------------------+-----------------------+---------------------+-------------------------+-------------------+-----------------------+---------------+----+-----+------------------+-------------+----------------+--------------------+-------------+---------+----------------+--------------------+--------------------+-------------+---------+--------------------+\nonly showing top 20 rows\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\norg.apache.hadoop.mapred.FileAlreadyExistsException: Output directory file:/usr/tweets/tweetsTest already exists\n  at org.apache.hadoop.mapred.FileOutputFormat.checkOutputSpecs(FileOutputFormat.java:131)\n  at org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopDataset$1.apply$mcV$sp(PairRDDFunctions.scala:1184)\n  at org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopDataset$1.apply(PairRDDFunctions.scala:1161)\n  at org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopDataset$1.apply(PairRDDFunctions.scala:1161)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n  at org.apache.spark.rdd.RDD.withScope(RDD.scala:358)\n  at org.apache.spark.rdd.PairRDDFunctions.saveAsHadoopDataset(PairRDDFunctions.scala:1161)\n  at org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$4.apply$mcV$sp(PairRDDFunctions.scala:1064)\n  at org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$4.apply(PairRDDFunctions.scala:1030)\n  at org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$4.apply(PairRDDFunctions.scala:1030)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n  at org.apache.spark.rdd.RDD.withScope(RDD.scala:358)\n  at org.apache.spark.rdd.PairRDDFunctions.saveAsHadoopFile(PairRDDFunctions.scala:1030)\n  at org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$1.apply$mcV$sp(PairRDDFunctions.scala:956)\n  at org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$1.apply(PairRDDFunctions.scala:956)\n  at org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$1.apply(PairRDDFunctions.scala:956)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n  at org.apache.spark.rdd.RDD.withScope(RDD.scala:358)\n  at org.apache.spark.rdd.PairRDDFunctions.saveAsHadoopFile(PairRDDFunctions.scala:955)\n  at org.apache.spark.rdd.RDD$$anonfun$saveAsTextFile$1.apply$mcV$sp(RDD.scala:1459)\n  at org.apache.spark.rdd.RDD$$anonfun$saveAsTextFile$1.apply(RDD.scala:1438)\n  at org.apache.spark.rdd.RDD$$anonfun$saveAsTextFile$1.apply(RDD.scala:1438)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n  at org.apache.spark.rdd.RDD.withScope(RDD.scala:358)\n  at org.apache.spark.rdd.RDD.saveAsTextFile(RDD.scala:1438)\n  ... 50 elided\n"}},{"config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"place","index":0,"aggr":"sum"}],"values":[{"name":"c","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"place","index":0,"aggr":"sum"},"yAxis":{"name":"c","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","helium":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1484429854301_-746734440","id":"20170114-213734_1492714065","dateCreated":"2017-01-14T21:37:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2290","text":"%sql\nSELECT place,count(*) as c FROM Test1 where text LIKE '%Jordan %' and place is not null  group by place order by c desc limit 10","user":"anonymous","dateUpdated":"2017-01-14T21:38:45+0000","dateFinished":"2017-01-14T21:38:40+0000","dateStarted":"2017-01-14T21:38:39+0000","result":{"code":"SUCCESS","type":"TABLE","msg":"place\tc\n"}},{"text":"%sql\n","dateUpdated":"2017-01-14T21:37:53+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1484429873991_-689391530","id":"20170114-213753_1602784499","dateCreated":"2017-01-14T21:37:53+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2392"}],"name":"Demo","id":"2C7TSJ6JS","angularObjects":{"2C7FS1BHF:shared_process":[],"2C72KFAZM:shared_process":[],"2C7EYSJ2R:shared_process":[],"2C82SJ9YM:shared_process":[],"2C5VFSPHF:shared_process":[],"2C71XNAN5:shared_process":[],"2C7WJ1Q7C:shared_process":[],"2C6UHRZQK:shared_process":[],"2C7S13ZER:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}