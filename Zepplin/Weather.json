{"paragraphs":[{"text":"import org.apache.spark.SparkConf;\r\nimport org.apache.spark.SparkContext;\r\nimport org.apache.spark.sql.SQLContext;\r\n\r\nSystem.setProperty(\"hadoop.home.dir\",\"/usr/hadoop-2.7.3/bin\");\r\n// initialise spark context\r\n//val conf = new SparkConf().setAppName(\"PbSpark\").setMaster(\"local[2]\").set(\"spark.executor.memory\", \"4g\").set(\"spark.driver.allowMultipleContexts\",\"true\");\r\n//val sc = new SparkContext(conf);\r\n\r\n//val sqlContext = new SQLContext(sc);\r\nval EntertainmentTable = sqlContext.jsonFile(\"/usr/tweets/tweets4.json\");\r\nEntertainmentTable.registerTempTable(\"Weather\");\r\n//EntertainmentTable.printSchema();\r\nval maxTweets =sqlContext.sql(\"SELECT lang, count(*) as c FROM Weather where lang is not null  group by lang order by c desc limit 10\");\r\n//sqlContext.sql(\"SELECT TRIM( REGEXP_REPLACE( SUBSTR(source,instr(source,”>”)+1),”/a>”,”” ) ) AS Device, COUNT(TRIM(source)) AS PerCount FROM zumamustfall_db.zmf_tweets GROUP BY TRIM( REGEXP_REPLACE( SUBSTR(source,instr(source,”>”)+1),”/a>”,”” ) ) HAVING COUNT(TRIM(source)) >= 2 ORDER BY PerCount DESC LIMIT 10 \"); \r\n  //sqlContext.sql(\"SELECT lang, count(*) as c FROM EntertainmentTable where lang is not null  group by lang order by c desc limit 10\");\r\nmaxTweets.show();\r\nEntertainmentTable.show();\r\n//maxTweets.rdd.saveAsTextFile(\"/usr/tweets/tweetsTest\");","user":"anonymous","dateUpdated":"2017-01-14T16:22:45+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1484410923038_817732248","id":"20170114-162203_1743565418","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.SparkConf\n\nimport org.apache.spark.SparkContext\n\nimport org.apache.spark.sql.SQLContext\n\nres134: String = /usr/hadoop-2.7.3/bin\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\nEntertainmentTable: org.apache.spark.sql.DataFrame = [contributors: string, coordinates: struct<coordinates: array<double>, type: string> ... 31 more fields]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\nmaxTweets: org.apache.spark.sql.DataFrame = [lang: string, c: bigint]\n+----+---+\n|lang|  c|\n+----+---+\n|  en|226|\n| und|  2|\n|  es|  1|\n|  th|  1|\n+----+---+\n\n+------------+--------------------+--------------------+------------------+--------------------+--------------------+--------------+--------------+---------+------------+--------------------+------------------+------------------+-----------------------+---------------------+-------------------------+-------------------+-----------------------+---------------+----+--------------------+------------------+--------------------+------------------+--------------------+-------------+---------+--------------------+--------------------+--------------------+-------------+---------+--------------------+\n|contributors|         coordinates|          created_at|display_text_range|            entities|   extended_entities|extended_tweet|favorite_count|favorited|filter_level|                 geo|                id|            id_str|in_reply_to_screen_name|in_reply_to_status_id|in_reply_to_status_id_str|in_reply_to_user_id|in_reply_to_user_id_str|is_quote_status|lang|               place|possibly_sensitive|       quoted_status|  quoted_status_id|quoted_status_id_str|retweet_count|retweeted|    retweeted_status|              source|                text| timestamp_ms|truncated|                user|\n+------------+--------------------+--------------------+------------------+--------------------+--------------------+--------------+--------------+---------+------------+--------------------+------------------+------------------+-----------------------+---------------------+-------------------------+-------------------+-----------------------+---------------+----+--------------------+------------------+--------------------+------------------+--------------------+-------------+---------+--------------------+--------------------+--------------------+-------------+---------+--------------------+\n|        null|                null|Mon Jan 16 14:55:...|              null|[WrappedArray(),n...|                null|          null|             0|    false|         low|                null|821007979306741760|821007979306741760|                   null|                 null|                     null|               null|                   null|          false|  en|                null|             false|                null|              null|                null|            0|    false|[null,null,Mon Ja...|<a href=\"http://t...|RT @HoustontexasT...|1484578530514|    false|[false,Thu Aug 01...|\n|        null|                null|Mon Jan 16 14:57:...|           [0, 65]|[WrappedArray([Wr...|                null|          null|             0|    false|         low|                null|821008550243823617|821008550243823617|                   null|                 null|                     null|               null|                   null|           true|  en|                null|             false|[null,[WrappedArr...|821005272101556229|  821005272101556229|            0|    false|                null|<a href=\"http://t...|Here we go again....|1484578666636|    false|[false,Tue Oct 11...|\n|        null|                null|Mon Jan 16 14:57:...|              null|[WrappedArray(),n...|                null|          null|             0|    false|         low|                null|821008551862796289|821008551862796289|                   null|                 null|                     null|               null|                   null|          false|  en|                null|             false|                null|              null|                null|            0|    false|                null|<a href=\"https://...|...The Flood Warn...|1484578667022|    false|[false,Sun Jun 19...|\n|        null|                null|Mon Jan 16 14:58:...|              null|[WrappedArray(),n...|                null|          null|             0|    false|         low|                null|821008625028231170|821008625028231170|                   null|                 null|                     null|               null|                   null|          false|  en|                null|             false|                null|              null|                null|            0|    false|[null,null,Mon Ja...|<a href=\"http://t...|RT @HoustontexasT...|1484578684466|    false|[false,Wed Jan 27...|\n|        null|                null|Mon Jan 16 14:58:...|              null|[WrappedArray(),n...|                null|          null|             0|    false|         low|                null|821008756796440577|821008756796440577|                   null|                 null|                     null|               null|                   null|          false|  en|                null|             false|                null|              null|                null|            0|    false|[null,null,Mon Ja...|<a href=\"https://...|RT @weatherchanne...|1484578715882|    false|[false,Thu Jul 24...|\n|        null|[WrappedArray(-88...|Mon Jan 16 15:00:...|              null|[WrappedArray(),n...|                null|          null|             0|    false|         low|[WrappedArray(41....|821009117632483329|821009117632483329|                   null|                 null|                     null|               null|                   null|          false|  en|[[WrappedArray(Wr...|             false|                null|              null|                null|            0|    false|                null|<a href=\"http://t...|Flood Warning iss...|1484578801912|    false|[false,Thu Aug 25...|\n|        null|[WrappedArray(-88...|Mon Jan 16 15:00:...|              null|[WrappedArray(),n...|                null|          null|             0|    false|         low|[WrappedArray(41....|821009119490539521|821009119490539521|                   null|                 null|                     null|               null|                   null|          false|  en|[[WrappedArray(Wr...|             false|                null|              null|                null|            0|    false|                null|<a href=\"http://t...|Flood Warning iss...|1484578802355|    false|[false,Thu Aug 25...|\n|        null|[WrappedArray(-88...|Mon Jan 16 15:00:...|              null|[WrappedArray(),n...|                null|          null|             0|    false|         low|[WrappedArray(41....|821009121059147776|821009121059147776|                   null|                 null|                     null|               null|                   null|          false|  en|[[WrappedArray(Wr...|             false|                null|              null|                null|            0|    false|                null|<a href=\"http://t...|Flood Warning iss...|1484578802729|    false|[false,Thu Aug 25...|\n|        null|[WrappedArray(-88...|Mon Jan 16 15:00:...|              null|[WrappedArray(),n...|                null|          null|             0|    false|         low|[WrappedArray(41....|821009123428929536|821009123428929536|                   null|                 null|                     null|               null|                   null|          false|  en|[[WrappedArray(Wr...|             false|                null|              null|                null|            0|    false|                null|<a href=\"http://t...|Flood Warning iss...|1484578803294|    false|[false,Thu Aug 25...|\n|        null|[WrappedArray(-88...|Mon Jan 16 15:00:...|              null|[WrappedArray(),n...|                null|          null|             0|    false|         low|[WrappedArray(41....|821009124976631810|821009124976631810|                   null|                 null|                     null|               null|                   null|          false|  en|[[WrappedArray(Wr...|             false|                null|              null|                null|            0|    false|                null|<a href=\"http://t...|Flood Warning iss...|1484578803663|    false|[false,Thu Feb 23...|\n|        null|                null|Mon Jan 16 15:01:...|              null|[WrappedArray(),W...|[WrappedArray([pi...|          null|             0|    false|         low|                null|821009426635177985|821009426635177985|                   null|                 null|                     null|               null|                   null|          false|  en|                null|             false|                null|              null|                null|            0|    false|[null,null,Sat Ja...|<a href=\"http://t...|RT @keithbell36: ...|1484578875584|    false|[false,Tue May 24...|\n|        null|                null|Mon Jan 16 15:01:...|           [0, 48]|[WrappedArray(),n...|                null|          null|             0|    false|         low|                null|821009530666487808|821009530666487808|            FriendlyJMC|                 null|                     null|         4821375853|             4821375853|           true|  en|                null|             false|[null,null,Mon Ja...|821007241578876929|  821007241578876929|            0|    false|                null|<a href=\"http://t...|@FriendlyJMC it p...|1484578900387|    false|[false,Sat Oct 08...|\n|        null|                null|Mon Jan 16 15:01:...|           [0, 88]|[WrappedArray(),n...|                null|          null|             0|    false|         low|                null|821009605568450560|821009605568450560|                   null|                 null|                     null|               null|                   null|           true|  en|                null|             false|[null,null,Mon Ja...|821001556128579584|  821001556128579584|            0|    false|                null|<a href=\"http://b...|Interesting and e...|1484578918245|    false|[false,Wed Feb 20...|\n|        null|                null|Mon Jan 16 15:02:...|           [0, 62]|[WrappedArray([Wr...|                null|          null|             0|    false|         low|                null|821009648664842240|821009648664842240|                   null|                 null|                     null|               null|                   null|           true|  en|                null|             false|[null,null,Mon Ja...|821002108682047488|  821002108682047488|            0|    false|                null|<a href=\"http://t...|Sure hope my hous...|1484578928520|    false|[false,Thu Nov 10...|\n|        null|                null|Mon Jan 16 15:02:...|           [0, 29]|[WrappedArray(),n...|                null|          null|             0|    false|         low|                null|821009717178826752|821009717178826752|                   null|                 null|                     null|               null|                   null|           true|  en|                null|             false|[null,null,Mon Ja...|821000494533509120|  821000494533509120|            0|    false|                null|<a href=\"http://t...|This weather man,...|1484578944855|    false|[false,Tue Nov 22...|\n|        null|                null|Mon Jan 16 15:02:...|              null|[WrappedArray(),n...|                null|          null|             0|    false|         low|                null|821009796388130816|821009796388130816|                   null|                 null|                     null|               null|                   null|          false|  en|                null|             false|                null|              null|                null|            0|    false|                null|<a href=\"http://w...|Tornado Warning f...|1484578963740|    false|[false,Mon Feb 16...|\n|        null|                null|Mon Jan 16 15:02:...|              null|[WrappedArray(),n...|                null|          null|             0|    false|         low|                null|821009797398994944|821009797398994944|                   null|                 null|                     null|               null|                   null|          false|  en|                null|             false|                null|              null|                null|            0|    false|                null|<a href=\"http://w...|Tornado Warning f...|1484578963981|    false|[false,Mon Feb 22...|\n|        null|                null|Mon Jan 16 15:02:...|              null|[WrappedArray([Wr...|                null|          null|             0|    false|         low|                null|821009813211676672|821009813211676672|                   null|                 null|                     null|               null|                   null|          false|  en|                null|              null|                null|              null|                null|            0|    false|[null,null,Fri Ja...|<a href=\"http://t...|RT @EnvAgency: We...|1484578967751|    false|[false,Tue Aug 04...|\n|        null|                null|Mon Jan 16 15:02:...|              null|[WrappedArray(),n...|                null|          null|             0|    false|         low|                null|821009822715879424|821009822715879424|                   null|                 null|                     null|               null|                   null|          false|  en|                null|             false|                null|              null|                null|            0|    false|                null|<a href=\"http://w...|Tornado Warning f...|1484578970017|    false|[false,Sun Jan 11...|\n|        null|                null|Mon Jan 16 15:02:...|              null|[WrappedArray([Wr...|                null|          null|             0|    false|         low|                null|821009830500515847|821009830500515847|                   null|                 null|                     null|               null|                   null|          false|  en|                null|              null|                null|              null|                null|            0|    false|                null|<a href=\"http://w...|Tornado Warning f...|1484578971873|    false|[false,Thu Mar 03...|\n+------------+--------------------+--------------------+------------------+--------------------+--------------------+--------------+--------------+---------+------------+--------------------+------------------+------------------+-----------------------+---------------------+-------------------------+-------------------+-----------------------+---------------+----+--------------------+------------------+--------------------+------------------+--------------------+-------------+---------+--------------------+--------------------+--------------------+-------------+---------+--------------------+\nonly showing top 20 rows\n\n"},"dateCreated":"2017-01-14T16:22:03+0000","dateStarted":"2017-01-14T16:22:45+0000","dateFinished":"2017-01-14T16:22:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:200"},{"text":"","dateUpdated":"2017-01-14T20:55:06+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1484427296807_-1421814397","id":"20170114-205456_1763780147","dateCreated":"2017-01-14T20:54:56+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:201"},{"text":"%sql\nSELECT user.created_at, count(*) as c FROM Weather where user.created_at is not null and user.location IN ('Houston')  group by user.created_at order by c desc limit 10\n","user":"anonymous","dateUpdated":"2017-01-14T21:39:13+0000","config":{"colWidth":12,"graph":{"mode":"stackedAreaChart","height":300,"optionOpen":false,"keys":[{"name":"created_at","index":0,"aggr":"sum"}],"values":[{"name":"c","index":1,"aggr":"sum"}],"groups":[],"scatter":{"yAxis":{"name":"c","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","helium":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1484410945955_-702380008","id":"20170114-162225_1966782201","result":{"code":"SUCCESS","type":"TABLE","msg":"created_at\tc\nTue Oct 11 16:23:03 +0000 2011\t1\nMon Aug 03 17:54:20 +0000 2009\t1\n"},"dateCreated":"2017-01-14T16:22:25+0000","dateStarted":"2017-01-14T21:39:13+0000","dateFinished":"2017-01-14T21:39:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:202"},{"text":"println(s\"\"\"%html\n<script>\nvar url = \"get_data.php\";\nvar params = \"lorem=ipsum&name=binny\";\nhttp.open(\"GET\", url+\"?\"+params, true);\nhttp.onreadystatechange = function() {//Call a function when the state changes.\n\tif(http.readyState == 4 && http.status == 200) {\n\t\talert(http.responseText);\n\t}\n}\nhttp.send(null);\n</script>\n\"\"\")\n","user":"anonymous","dateUpdated":"2017-01-14T20:55:52+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1484411131750_695841823","id":"20170114-162531_455344943","result":{"code":"SUCCESS","type":"HTML","msg":"<script>\nvar url = \"get_data.php\";\nvar params = \"lorem=ipsum&name=binny\";\nhttp.open(\"GET\", url+\"?\"+params, true);\nhttp.onreadystatechange = function() {//Call a function when the state changes.\n\tif(http.readyState == 4 && http.status == 200) {\n\t\talert(http.responseText);\n\t}\n}\nhttp.send(null);\n</script>\n\n"},"dateCreated":"2017-01-14T16:25:31+0000","dateStarted":"2017-01-14T20:55:52+0000","dateFinished":"2017-01-14T20:55:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:203"},{"text":"","dateUpdated":"2017-01-14T20:42:05+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1484426515293_1399827888","id":"20170114-204155_514891233","dateCreated":"2017-01-14T20:41:55+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:204"}],"name":"Weather","id":"2C5MHGY53","angularObjects":{"2C7FS1BHF:shared_process":[],"2C72KFAZM:shared_process":[],"2C7EYSJ2R:shared_process":[],"2C82SJ9YM:shared_process":[],"2C5VFSPHF:shared_process":[],"2C71XNAN5:shared_process":[],"2C7WJ1Q7C:shared_process":[],"2C6UHRZQK:shared_process":[],"2C7S13ZER:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}